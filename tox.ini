[tox]
envlist = py36,py37,py38,coverage,benchmark,docs

[testenv]
changedir = test
whitelist_externals = bash
commands =
    bash -c "ln -sf /usr/lib64/python3.7/site-packages/rdkit/ $VIRTUAL_ENV/lib64/python3.7/site-packages"
    pytest

[pytest]
addopts = -ra
python_files = *.py
python_functions = test_*
norecursedirs = .tox .git

[testenv:py36]
basepython = python3.6
deps =
    -rrequirements/tests.txt
    -rrequirements/common.txt

[testenv:py37]
basepython = python3.7
deps =
    -rrequirements/tests.txt
    -rrequirements/common.txt

[testenv:py38]
basepython = python3.8
deps =
    -rrequirements/tests.txt
    -rrequirements/common.txt

[testenv:coverage]
basepython = python3.7
deps =
    -rrequirements/tests.txt
    -rrequirements/common.txt
commands =
    bash -c "ln -sf /usr/lib64/python3.7/site-packages/rdkit/ $VIRTUAL_ENV/lib64/python3.7/site-packages"
    pytest --cov=graphdot --cov-report=term --cov-report=html

[testenv:benchmark]
changedir = benchmark
basepython = python3.7
deps =
    -rrequirements/tests.txt
    -rrequirements/common.txt
commands =
    bash -c "ln -sf /usr/lib64/python3.7/site-packages/rdkit/ $VIRTUAL_ENV/lib64/python3.7/site-packages"
    pytest --benchmark-only 

[testenv:docs]
basepython = python3.7
changedir = docs
deps =
    -rrequirements/docs.txt
commands =
    bash -c "ln -sf /usr/lib64/python3.7/site-packages/rdkit/ $VIRTUAL_ENV/lib64/python3.7/site-packages"
    sphinx-build -b html . _build/html
